{# -*- coding: utf-8 -*-
#
# This file is part of ClaimStore.
# Copyright (C) 2015 CERN.
#
# ClaimStore is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License as
# published by the Free Software Foundation; either version 3 of the
# License, or (at your option) any later version.
#
# ClaimStore is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
# General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with ClaimStore; if not, write to the Free Software Foundation, Inc.,
# 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
#}

{% extends "claims/base.html" %}

{% block css %}
  {{ super() }}
  <link href="{{ url_for('static', filename='css/docs.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}

<div class="row doc-container">
  <div class="col-sm-3 col-md-3 hidden-print">
    <ul class="nav nav-list sidebar-nav">
      <li class="nav-header">ClaimStore Docs</li>
      <li><a class="page-scroll" href="#subscription">Subscribe</a></li>
      <li><a class="page-scroll" href="#submitclaim">Submit claims</a></li>
      <li><a class="page-scroll" href="#listclaims">List claims</a></li>
      <li><a class="page-scroll" href="#listidentifiers">List identifiers</a></li>
      <li><a class="page-scroll" href="#listpredicates">List predicates</a></li>
    </ul>
  </div>
  <div class="col-sm-9 col-md-9 doc-content">
    <h1 class="doc-title-1">API Documentation</h1>
    <p>To be completed</p>
    <h1 class="doc-title-1">Resources</h1>
    <p>List of resources available at ClaimStore</p>
    <section id="subscription">
      <h3>Subscribe to ClaimStore</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-striped">
          <colgroup>
            <col class="col-xs-1">
            <col class="col-xs-7">
          </colgroup>
          <thead>
            <tr>
              <th colspan="2">POST /subscribe</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">Description</th>
              <td>Registers a new claimant into ClaimStore</td>
            </tr>
            <tr>
              <th scope="row">URL</th>
              <td>http://localhost:5000/subscribe</td>
            </tr>
            <tr>
              <th scope="row">Method</th>
              <td>POST</td>
            </tr>
            <tr>
              <th scope="row">Request headers</th>
              <td>Content-Type: application/json</td>
            </tr>
            <tr>
              <th scope="row">Data parameters</th>
              <td>
                <p>JSON with the information of the claimant. The JSON data should be valid according to the <a href="{{ url_for('static', filename='json/schemas/claimant.json') }}">JSON Schema for claimants</a>.</p>
              </td>
            </tr>
            <tr>
              <th scope="row">Success response</th>
              <td>
                <ul>
                  <li>Code: <code>200 OK</code></li>
                  <li>Body: JSON with status and message</li>
                </ul>
              </td>
            </tr>
            <tr>
              <th scope="row">Error response</th>
              <td>
                <ul>
                  <li>Code: <code>40X</code></li>
                  <li>Body: JSON with status and message</li>
                </ul>
              </td>
            </tr>
            <tr>
              <th scope="row">Example</th>
              <td>
                <ul id="example-tabs-subs" class="nav nav-tabs">
                  <li role="presentation" class="active"><a href="#httpie-subscribe" data-toogle="tab">httpie</a></li>
                  <li role="presentation"><a href="#curl-subscribe" data-toogle="tab">cURL</a></li>
                  <li role="presentation"><a href="#python-subscribe" data-toogle="tab">Python</a></li>
                </ul>
                <div class="tab-content">
                  <div class="tab-pane active" id="httpie-subscribe">
                    <br />
                    <pre>http POST http://localhost:5000/subscribe &lt; <a href="{{ url_for('static', filename='json/examples/claimant.cds.json') }}">json/examples/claimant.cds.json</a></pre>
                  </div>
                  <div class="tab-pane curl" id="curl-subscribe">
                    <br />
                    <pre>curl http://localhost:5000/subscribe -H "Content-Type: application/json" -d '{"name":"INSPIRE", "url": "http://inspirehep.net", "persistent_identifiers":[{"type":"INSPIRE_RECORD_ID", "description":"INSPIRE record", "url": "http://inspirehep.net/record/&lt;INSPIRE_RECORD_ID&gt;", "example_value": "123", "example_url":"http://inspirehep.net/record/123"}, {"type": "INSPIRE_AUTHOR_ID", "description": "INSPIRE author", "url": "http://inspirehep.net/author/&lt;INSPIRE_AUTHOR_ID&gt;", "example_value": "J.R. Ellis.1", "example_url": "http://inspirehep.net/author/J.R.Ellis.1"}]}' -X POST -v</pre>
                  </div>
                  <div class="tab-pane" id="python-subscribe">
                    <br />
                    <pre>
import json
import requests

url = "http://localhost:5000/subscribe/
headers = {"Content-Type": "application/json"}
with open('$PROJECT_HOME/claimstore/static/json/examples/claimant.cds.json') as f:
    data=json.dumps(f.read())
r = requests.post(url, data=data, headers=headers)
                    </pre>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
    <section id="submitclaim">
      <h3>Submit a claim</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-striped">
          <colgroup>
            <col class="col-xs-1">
            <col class="col-xs-7">
          </colgroup>
          <thead>
            <tr>
              <th colspan="2">POST /claims</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">Description</th>
              <td>Stores a new claim in ClaimStore</td>
            </tr>
            <tr>
              <th scope="row">URL</th>
              <td>http://localhost:5000/claims</td>
            </tr>
            <tr>
              <th scope="row">Method</th>
              <td>POST</td>
            </tr>
            <tr>
              <th scope="row">Request headers</th>
              <td>Content-Type: application/json</td>
            </tr>
            <tr>
              <th scope="row">Data parameters</th>
              <td>
                <p>JSON with the information of the claim. The JSON data should be valid according to the <a href="{{ url_for('static', filename='json/schemas/claim.json') }}">JSON Schema for claims</a>.</p>
              </td>
            </tr>
            <tr>
              <th scope="row">Success response</th>
              <td>
                <ul>
                  <li>Code: <code>200 OK</code></li>
                  <li>Body: JSON with status and message</li>
                </ul>
              </td>
            </tr>
            <tr>
              <th scope="row">Error response</th>
              <td>
                <ul>
                  <li>Code: <code>40X</code></li>
                  <li>Body: JSON with status and message</li>
                </ul>
              </td>
            </tr>
            <tr>
              <th scope="row">Example</th>
              <td>
                <ul id="example-tabs-claim" class="nav nav-tabs">
                  <li role="presentation" class="active"><a href="#httpie-claim" data-toogle="tab">httpie</a></li>
                  <li role="presentation"><a href="#curl-claim" data-toogle="tab">cURL</a></li>
                  <li role="presentation"><a href="#python-claim" data-toogle="tab">Python</a></li>
                </ul>
                <div class="tab-content">
                  <div class="tab-pane active" id="httpie-claim">
                    <br />
                    <pre>http POST http://localhost:5000/claims &lt; <a href="{{ url_for('static', filename='json/examples/claim.cds.json') }}">json/examples/claim.cds.json</a></pre>
                  </div>
                  <div class="tab-pane curl" id="curl-claim">
                    <br />
                    <pre>curl http://localhost:5000/claims -H "Content-Type: application/json" -d '{"claimant":"CDS", "object": {"type": "CDS_RECORD_ID", "value": "CMS-PAS-HIG-14-008"}, "claim": {"predicate": "is_same_as", "created": "2015-05-25 11:00:00 UTC", "certainty": 1, "arguments":{"human": 0, "actor": "CDS_submission"}}, "subject": {"type": "CDS_REPORT_NUMBER", "value": "2001192"}}' -X POST -v</pre>
                  </div>
                  <div class="tab-pane" id="python-claim">
                    <br />
                                        <pre>
import json
import requests

url = "http://localhost:5000/claims/
headers = {"Content-Type": "application/json"}
with open('$PROJECT_HOME/claimstore/static/json/examples/claim.cds.1.json') as f:
    data=json.dumps(f.read())
r = requests.post(url, data=data, headers=headers)</pre>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
    <section id="listclaims">
      <h3>List claims</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-striped">
          <colgroup>
            <col class="col-xs-1">
            <col class="col-xs-7">
          </colgroup>
          <thead>
            <tr>
              <th colspan="2">GET /claims</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">Description</th>
              <td>List of claims in ClaimStore</td>
            </tr>
            <tr>
              <th scope="row">URL</th>
              <td><a href="{{ url_for('claims_restful.claims') }}">http://localhost:5000/claims</a></td>
            </tr>
            <tr>
              <th scope="row">URL parameters</th>
              <p>All parameters are optional.</p>
              <td>
                <ul>
                  <li>since: claims created from this date (format: YYYY-MM-DD).</li>
                  <li>until: claims created until this date (format: YYYY-MM-DD).</li>
                  <li>claimant: claimant's name as it was registered (e.g. CDS).</li>
                  <li>predicate: predicate's name (e.g. is_same_as) </li>
                  <li>certainty: number between 0 and 1.0 (e.g. 0.5). It will search for claims with at least the specified certainty.</li>
                  <li>human: enter 1 if searching for human-created claims, 0 for algorithms and nothing for retrieving all.</li>
                  <li>actor: actor's name (one can use %).</li>
                  <li>role: actor's role (one can use %).</li>
                  <li>type: identifier type (e.g. DOI).</li>
                  <li>value: identifier value (e.g. 20110301).</li>
                  <li>subject: identifier type used as a subject type.</li>
                  <li>object: identifier type used as an object type.</li>
                </ul>
              </td>
            </tr>
            <tr>
              <th scope="row">Method</th>
              <td>GET</td>
            </tr>
            <tr>
              <th scope="row">Success response</th>
              <td>
                <p>JSON list with all the claims.</p>
              </td>
            </tr>
            <tr>
              <th scope="row">Error response</th>
              <td>
                <ul>
                  <li>Code: <code>40X</code></li>
                  <li>Body: JSON with status and message</li>
                </ul>
              </td>
            </tr>
            <tr>
              <th scope="row">Example</th>
              <td>
                <ul id="example-tabs-list" class="nav nav-tabs">
                  <li role="presentation" class="active"><a href="#httpie-list-claims" data-toogle="tab">httpie</a></li>
                  <li role="presentation"><a href="#curl-list-claims" data-toogle="tab">cURL</a></li>
                  <li role="presentation"><a href="#python-list-claims" data-toogle="tab">Python</a></li>
                </ul>
                <div class="tab-content">
                  <div class="tab-pane active" id="httpie-list-claims">
                    <br />
                    <pre>http GET http://localhost:5000/claims</pre>
                  </div>
                  <div class="tab-pane curl" id="curl-list-claims">
                    <br />
                    <pre>curl http://localhost:5000/claims</pre>
                  </div>
                  <div class="tab-pane" id="python-list-claims">
                    <br />
                    <pre>
import requests
response = requests.get("http://localhost:5000/claims")
print response.json()
                    </pre>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
    <section id="listidentifiers">
      <h3>List identifiers</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-striped">
          <colgroup>
            <col class="col-xs-1">
            <col class="col-xs-7">
          </colgroup>
          <thead>
            <tr>
              <th colspan="2">GET /identifiers</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">Description</th>
              <td>List of identifiers in ClaimStore</td>
            </tr>
            <tr>
              <th scope="row">URL</th>
              <td><a href="{{ url_for('claims_restful.identifiers') }}">http://localhost:5000/identifiers</a></td>
            </tr>
            <tr>
              <th scope="row">Method</th>
              <td>GET</td>
            </tr>
            <tr>
              <th scope="row">Success response</th>
              <td>
                <p>JSON list with all the identifiers.</p>
              </td>
            </tr>
            <tr>
              <th scope="row">Error response</th>
              <td>
                <ul>
                  <li>Code: <code>40X</code></li>
                  <li>Body: JSON with status and message</li>
                </ul>
              </td>
            </tr>
            <tr>
              <th scope="row">Example</th>
              <td>
                <ul id="example-tabs-list" class="nav nav-tabs">
                  <li role="presentation" class="active"><a href="#httpie-list-identifiers" data-toogle="tab">httpie</a></li>
                  <li role="presentation"><a href="#curl-list-identifiers" data-toogle="tab">cURL</a></li>
                  <li role="presentation"><a href="#python-list-identifiers" data-toogle="tab">Python</a></li>
                </ul>
                <div class="tab-content">
                  <div class="tab-pane active" id="httpie-list-identifiers">
                    <br />
                    <pre>http GET http://localhost:5000/identifiers</pre>
                  </div>
                  <div class="tab-pane curl" id="curl-list-identifiers">
                    <br />
                    <pre>curl http://localhost:5000/identifiers</pre>
                  </div>
                  <div class="tab-pane" id="python-list-identifiers">
                    <br />
                    <pre>
import requests
response = requests.get("http://localhost:5000/identifiers")
print response.json()
                    </pre>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
    <section id="listpredicates">
      <h3>List predicates</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-striped">
          <colgroup>
            <col class="col-xs-1">
            <col class="col-xs-7">
          </colgroup>
          <thead>
            <tr>
              <th colspan="2">GET /predicates</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">Description</th>
              <td>List of predicates in ClaimStore</td>
            </tr>
            <tr>
              <th scope="row">URL</th>
              <td><a href="{{ url_for('claims_restful.predicates') }}">http://localhost:5000/predicates</a></td>
            </tr>
            <tr>
              <th scope="row">Method</th>
              <td>GET</td>
            </tr>
            <tr>
              <th scope="row">Success response</th>
              <td>
                <p>JSON list with all the predicates.</p>
              </td>
            </tr>
            <tr>
              <th scope="row">Error response</th>
              <td>
                <ul>
                  <li>Code: <code>40X</code></li>
                  <li>Body: JSON with status and message</li>
                </ul>
              </td>
            </tr>
            <tr>
              <th scope="row">Example</th>
              <td>
                <ul id="example-tabs-list" class="nav nav-tabs">
                  <li role="presentation" class="active"><a href="#httpie-list-predicates" data-toogle="tab">httpie</a></li>
                  <li role="presentation"><a href="#curl-list-predicates" data-toogle="tab">cURL</a></li>
                  <li role="presentation"><a href="#python-list-predicates" data-toogle="tab">Python</a></li>
                </ul>
                <div class="tab-content">
                  <div class="tab-pane active" id="httpie-list-predicates">
                    <br />
                    <pre>http GET http://localhost:5000/predicates</pre>
                  </div>
                  <div class="tab-pane curl" id="curl-list-predicates">
                    <br />
                    <pre>curl http://localhost:5000/predicates</pre>
                  </div>
                  <div class="tab-pane" id="python-list-predicates">
                    <br />
                    <pre>
import requests
response = requests.get("http://localhost:5000/predicates")
print response.json()
                    </pre>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </div>
</div>

{% endblock %}

{% block scripts %}

{{ super() }}

<script type="text/javascript">
  $('ul[id^=example-tabs] a').click(function (e) {
    e.preventDefault();
    $(this).tab('show');
  });
</script>

{% endblock %}
